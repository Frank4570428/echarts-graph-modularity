!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("echarts")):"function"==typeof define&&define.amd?define(["echarts"],t):"object"==typeof exports?exports["echarts-graph-modularity"]=t(require("echarts")):e["echarts-graph-modularity"]=t(e.echarts)}(this,function(e){return function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){function o(e){return function(t,r){var o={};t.eachSeriesByType(e,function(e){if(e.get("modularity")){var t=e.getGraph(),r={},a=t.data.mapArray(function(e){var o=t.getNodeByIndex(e);return r[o.id]=e,o.id}),s=t.edgeData.mapArray("value",function(e,r){var o=t.getEdgeByIndex(r);return{source:o.node1.id,target:o.node2.id,value:e}}),c=n().nodes(a).edges(s).partition_init(),i=c();for(var u in i){var f=i[u];t.data.setItemVisual(r[u],"color",e.getColorFromPalette(f,o))}t.edgeData.each(function(e){var r=t.edgeData.getItemModel(e),o=t.getEdgeByIndex(e),n=r.get("lineStyle.normal.color");switch(n){case"source":n=o.node1.getVisual("color");break;case"target":n=o.node2.getVisual("color")}null!=n&&o.setVisual("color",n)})}})}}var n=r(2),a=r(3);a.registerVisual(a.PRIORITY.VISUAL.CHART+1,o("graph")),a.registerVisual(a.PRIORITY.VISUAL.CHART+1,o("graphGL"))},function(e,t){jLouvain=function(){function e(e){var t={};return e.forEach(function(e,r){t[e]=!0}),Object.keys(t)}function t(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t}function r(e,t){var r=e._assoc_mat[t]?Object.keys(e._assoc_mat[t]):[],o=0;return r.forEach(function(r,n){var a=e._assoc_mat[t][r]||1;t===r&&(a*=2),o+=a}),o}function o(e,t){return void 0===e._assoc_mat[t]?[]:Object.keys(e._assoc_mat[t])}function n(e,t,r){return e._assoc_mat[t]?e._assoc_mat[t][r]:void 0}function a(e){var t=0;return e.edges.forEach(function(e){t+=e.weight}),t}function s(e,t){i(e,t);var r=e.edges.map(function(e){return e.source+"_"+e.target}).indexOf(t.source+"_"+t.target);-1!==r?e.edges[r].weight=t.weight:e.edges.push(t)}function c(e){var t={};return e.forEach(function(e,r){t[e.source]=t[e.source]||{},t[e.source][e.target]=e.weight,t[e.target]=t[e.target]||{},t[e.target][e.source]=e.weight}),t}function i(e,t){e._assoc_mat[t.source]=e._assoc_mat[t.source]||{},e._assoc_mat[t.source][t.target]=t.weight,e._assoc_mat[t.target]=e._assoc_mat[t.target]||{},e._assoc_mat[t.target][t.source]=t.weight}function u(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var r in e)t[r]=u(e[r]);return t}function f(e,t,s){t.nodes_to_com={},t.total_weight=0,t.internals={},t.degrees={},t.gdegrees={},t.loops={},t.total_weight=a(e),void 0===s?e.nodes.forEach(function(o,a){t.nodes_to_com[o]=a;var s=r(e,o);if(s<0)throw"Bad graph type, use positive weights!";t.degrees[a]=s,t.gdegrees[o]=s,t.loops[o]=n(e,o,o)||0,t.internals[a]=t.loops[o]}):e.nodes.forEach(function(n,a){var c=s[n];t.nodes_to_com[n]=c;var i=r(e,n);t.degrees[c]=(t.degrees[c]||0)+i,t.gdegrees[n]=i;var u=0;o(e,n).forEach(function(t,r){var o=e._assoc_mat[n][t];if(o<=0)throw"Bad graph type, use positive weights";s[t]===c&&(u+=t===n?o:o/2)}),t.internals[c]=(t.internals[c]||0)+u})}function g(r){var o=r.total_weight,n=0;return e(t(r.nodes_to_com)).forEach(function(e,t){var a=r.internals[e]||0,s=r.degrees[e]||0;o>0&&(n=n+a/o-Math.pow(s/(2*o),2))}),n}function d(e,t,r){var n={};return o(t,e).forEach(function(o,a){if(o!==e){var s=t._assoc_mat[e][o]||1,c=r.nodes_to_com[o];n[c]=(n[c]||0)+s}}),n}function h(e,t,r,o){o.nodes_to_com[e]=+t,o.degrees[t]=(o.degrees[t]||0)+(o.gdegrees[e]||0),o.internals[t]=(o.internals[t]||0)+r+(o.loops[e]||0)}function _(e,t,r,o){o.degrees[t]=(o.degrees[t]||0)-(o.gdegrees[e]||0),o.internals[t]=(o.internals[t]||0)-r-(o.loops[e]||0),o.nodes_to_com[e]=-1}function l(e){var t=0,r=u(e),o={};return Object.keys(e).forEach(function(n){var a=e[n],s=void 0===o[a]?-1:o[a];-1===s&&(o[a]=t,s=t,t+=1),r[n]=s}),r}function v(e,t){for(var r=!0,o=0,n=g(t),a=n;r&&o!==x&&(n=a,r=!1,o+=1,e.nodes.forEach(function(o,n){var a=t.nodes_to_com[o],s=(t.gdegrees[o]||0)/(2*t.total_weight),c=d(o,e,t);_(o,a,c[a]||0,t);var i=a,u=0;Object.keys(c).forEach(function(e,r){var o=c[e]-(t.degrees[e]||0)*s;o>u&&(u=o,i=e)}),h(o,i,c[i]||0,t),i!==a&&(r=!0)}),!((a=g(t))-n<j)););}function p(r,o){var a,c,i={nodes:[],edges:[],_assoc_mat:{}},u=t(r);return i.nodes=i.nodes.concat(e(u)),o.edges.forEach(function(e,t){c=e.weight||1;var o=r[e.source],u=r[e.target];a=n(i,o,u)||0,s(i,{source:o,target:u,weight:a+c})}),i}function m(e,t){for(var r=u(e[0]),o=1;o<t+1;o++)Object.keys(r).forEach(function(t,n){var a=t,s=r[t];r[a]=e[o][s]});return r}function y(e,t){if(0===e.edges.length){var r={};return e.nodes.forEach(function(e,t){r[e]=e}),r}var o={};f(O,o,t);var n=g(o),a=[];v(O,o);var s=g(o),c=l(o.nodes_to_com);a.push(c),n=s;var i=p(c,O);for(f(i,o);;){if(v(i,o),(s=g(o))-n<j)break;c=l(o.nodes_to_com),a.push(c),n=s,i=p(c,i),f(i,o)}return a}var w,E,b,x=-1,j=1e-7,O={},I=function(){var e=y(O,b);return m(e,e.length-1)};return I.nodes=function(e){return arguments.length>0&&(w=e),I},I.edges=function(e){if(void 0===w)throw"Please provide the graph nodes first!";if(arguments.length>0){E=e;var t=c(e);O={nodes:w,edges:E,_assoc_mat:t}}return I},I.partition_init=function(e){return arguments.length>0&&(b=e),I},I},e.exports=jLouvain},function(t,r){t.exports=e}])});